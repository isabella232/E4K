<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="521px" preserveAspectRatio="none" style="width:813px;height:521px;background:#FFFFFF;" version="1.1" viewBox="0 0 813 521" width="813px" zoomAndPan="magnify"><defs><filter height="300%" id="f1c7445acqgj51" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[8c7ae789eb43bff5c4d6f6a7f754eb4a]
cluster IoTEdgeSPIFFE Server--><rect fill="#FFFFFF" filter="url(#f1c7445acqgj51)" height="352" style="stroke:#000000;stroke-width:1.5;" width="739" x="7" y="7"/><path d="M175,7 L175,17.6094 L165,27.6094 L7,27.6094 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="158" x="10" y="22.5332">IoTEdgeSPIFFE Server</text><!--MD5=[9d3d1144af8acc9dcba823af675a1e9f]
entity API SVIDs--><rect fill="#FEFECE" filter="url(#f1c7445acqgj51)" height="47.6094" style="stroke:#A80036;stroke-width:1.5;" width="103" x="381.5" y="43"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="464.5" y="48"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="462.5" y="50"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="462.5" y="54"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="396.5" y="77.5332">API SVIDs</text><!--MD5=[859bac80a7a5e0d04f4f829c0ed273b7]
entity API Trust bundle--><rect fill="#FEFECE" filter="url(#f1c7445acqgj51)" height="47.6094" style="stroke:#A80036;stroke-width:1.5;" width="145" x="201.5" y="43"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="326.5" y="48"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="324.5" y="50"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="324.5" y="54"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="216.5" y="77.5332">API Trust bundle</text><!--MD5=[a6a9dcc9f5d93f845390bb8114bf3bfd]
entity Node attestation--><rect fill="#FEFECE" filter="url(#f1c7445acqgj51)" height="47.6094" style="stroke:#A80036;stroke-width:1.5;" width="143" x="23.5" y="43"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="146.5" y="48"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="144.5" y="50"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="144.5" y="54"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="38.5" y="77.5332">Node attestation</text><!--MD5=[31240fe2cf4422ed3c9bf793aa2602d1]
entity Admin inputs--><rect fill="#FEFECE" filter="url(#f1c7445acqgj51)" height="47.6094" style="stroke:#A80036;stroke-width:1.5;" width="121" x="23.5" y="295"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="124.5" y="300"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="122.5" y="302"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="122.5" y="306"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="38.5" y="329.5332">Admin inputs</text><!--MD5=[45eee4c5a57edb1e2ac175c76a239d17]
entity DataStore--><rect fill="#FEFECE" filter="url(#f1c7445acqgj51)" height="47.6094" style="stroke:#A80036;stroke-width:1.5;" width="104" x="180" y="295"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="264" y="300"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="262" y="302"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="262" y="306"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="195" y="329.5332">DataStore</text><!--MD5=[80c96f4e44443d3e5848f4691a298ebf]
entity SVID Signer--><rect fill="#FEFECE" filter="url(#f1c7445acqgj51)" height="47.6094" style="stroke:#A80036;stroke-width:1.5;" width="116" x="555" y="169"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="651" y="174"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="649" y="176"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="649" y="180"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="570" y="203.5332">SVID Signer</text><!--MD5=[617513e475bab683c122015175e7c2ba]
entity Key plugin--><rect fill="#FEFECE" filter="url(#f1c7445acqgj51)" height="47.6094" style="stroke:#A80036;stroke-width:1.5;" width="106" x="624" y="295"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="710" y="300"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="708" y="302"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="708" y="306"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="639" y="329.5332">Key plugin</text><!--MD5=[2a3074fbdbbd2557cbb283474ecf219d]
entity Key Manager--><rect fill="#FEFECE" filter="url(#f1c7445acqgj51)" height="47.6094" style="stroke:#A80036;stroke-width:1.5;" width="124" x="401" y="295"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="505" y="300"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="503" y="302"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="503" y="306"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="416" y="329.5332">Key Manager</text><!--MD5=[ff028a7ac4eed75d9278e76cd9053439]
entity HSM--><path d="M569.5,478 C569.5,468 594,468 594,468 C594,468 618.5,468 618.5,478 L618.5,504.6094 C618.5,514.6094 594,514.6094 594,514.6094 C594,514.6094 569.5,514.6094 569.5,504.6094 L569.5,478 " fill="#FEFECE" filter="url(#f1c7445acqgj51)" style="stroke:#000000;stroke-width:1.5;"/><path d="M569.5,478 C569.5,488 594,488 594,488 C594,488 618.5,488 618.5,478 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="579.5" y="506.5332">HSM</text><!--MD5=[c4629f4fe8b0781ca0e133ad2c48efb2]
entity Disk--><path d="M653.5,478 C653.5,468 677,468 677,468 C677,468 700.5,468 700.5,478 L700.5,504.6094 C700.5,514.6094 677,514.6094 677,514.6094 C677,514.6094 653.5,514.6094 653.5,504.6094 L653.5,478 " fill="#FEFECE" filter="url(#f1c7445acqgj51)" style="stroke:#000000;stroke-width:1.5;"/><path d="M653.5,478 C653.5,488 677,488 677,488 C677,488 700.5,488 700.5,478 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="663.5" y="506.5332">Disk</text><!--MD5=[2bba5e7b7fe4bc2fbd9825db3f1d4f93]
entity SQL--><path d="M159,478 C159,468 183,468 183,468 C183,468 207,468 207,478 L207,504.6094 C207,514.6094 183,514.6094 183,514.6094 C183,514.6094 159,514.6094 159,504.6094 L159,478 " fill="#FEFECE" filter="url(#f1c7445acqgj51)" style="stroke:#000000;stroke-width:1.5;"/><path d="M159,478 C159,488 183,488 183,488 C183,488 207,488 207,478 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="169" y="506.5332">SQL</text><!--MD5=[bdfad404fdf3df882c3ac71aa5606f51]
entity Memory--><path d="M736,478 C736,468 771,468 771,468 C771,468 806,468 806,478 L806,504.6094 C806,514.6094 771,514.6094 771,514.6094 C771,514.6094 736,514.6094 736,504.6094 L736,478 " fill="#FEFECE" filter="url(#f1c7445acqgj51)" style="stroke:#000000;stroke-width:1.5;"/><path d="M736,478 C736,488 771,488 771,488 C771,488 806,488 806,478 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="746" y="506.5332">Memory</text><!--MD5=[c169afe8ac3d73789757652984207207]
entity Memory2--><path d="M242,478 C242,468 281,468 281,468 C281,468 320,468 320,478 L320,504.6094 C320,514.6094 281,514.6094 281,514.6094 C281,514.6094 242,514.6094 242,504.6094 L242,478 " fill="#FEFECE" filter="url(#f1c7445acqgj51)" style="stroke:#000000;stroke-width:1.5;"/><path d="M242,478 C242,488 281,488 281,488 C281,488 320,488 320,478 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="252" y="506.5332">Memory2</text><!--MD5=[0cb3c390f649a54cbf77029fd03c10e8]
reverse link API Trust bundle to API SVIDs--><!--MD5=[8452fdf82770b6363140ebb69eb161bb]
reverse link Node attestation to API Trust bundle--><!--MD5=[c71b97002fcb5c4ca5809e89a980b139]
link Admin inputs to DataStore--><path d="M144.7,319 C154.67,319 164.64,319 174.61,319 " fill="none" id="Admin inputs-to-DataStore" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="179.83,319,170.83,315,174.83,319,170.83,323,179.83,319" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[3a334245b3731c229c5f5ae4442e8cd5]
link API Trust bundle to DataStore--><path d="M270.12,91.07 C262.39,137.12 245.06,240.25 236.7,290.05 " fill="none" id="API Trust bundle-to-DataStore" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="235.87,294.98,241.3067,286.7677,236.6989,290.0492,233.4175,285.4414,235.87,294.98" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="258" y="198.4951">Get pub keys</text><!--MD5=[fe9212833181d537161ec52dec214d18]
link API SVIDs to DataStore--><path d="M422.17,91.11 C407.23,121.66 378.36,176.37 345,217 C321.8,245.26 290.49,272.6 266.71,291.69 " fill="none" id="API SVIDs-to-DataStore" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="262.66,294.92,272.1933,292.4467,266.5727,291.807,267.2124,286.1864,262.66,294.92" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="379" y="198.4951">Check entries</text><!--MD5=[5c1ae6b16b458dbf188bf9774009bb3b]
link API SVIDs to SVID Signer--><path d="M466.43,91.03 C497.28,112.28 543.03,143.8 575.19,165.95 " fill="none" id="API SVIDs-to-SVID Signer" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="579.44,168.88,574.2762,160.4934,575.3152,166.054,569.7546,167.0931,579.44,168.88" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="534" y="135.4951">Sign SVID</text><!--MD5=[22b99612ce2f838e6fed15c1a4f542eb]
link SVID Signer to Key plugin--><path d="M624.89,217.03 C635.55,237.7 651.23,268.07 662.6,290.1 " fill="none" id="SVID Signer-to-Key plugin" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="664.96,294.67,664.3746,284.8386,662.6613,290.2297,657.2702,288.5164,664.96,294.67" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="649" y="261.4951">Sign Digest</text><!--MD5=[b7caaa185f3ee0cc40abb109f87d8c4b]
link Key Manager to Key plugin--><path d="M525.19,319 C554.58,319 589.48,319 618.4,319 " fill="none" id="Key Manager-to-Key plugin" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="623.73,319,614.73,315,618.73,319,614.73,323,623.73,319" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="543.5" y="312.4951">Add pkeys</text><!--MD5=[b50d6840cc2853418981f26cb5044a06]
reverse link DataStore to Key Manager--><path d="M289.48,319 C323.33,319 366.17,319 400.8,319 " fill="none" id="DataStore-backto-Key Manager" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="284.13,319,293.13,323,289.13,319,293.13,315,284.13,319" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="302.5" y="312.4951">Add pub keys</text><!--MD5=[ae6f7ae337736d7e25a3701b88134c5d]
link DataStore to SQL--><path d="M225.29,343.35 C216.33,374.52 200.49,429.63 190.95,462.84 " fill="none" id="DataStore-to-SQL" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="189.47,467.97,195.7827,460.4102,190.8398,463.1613,188.0887,458.2185,189.47,467.97" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[b907fc7029fa529ebe33c1585d7883cf]
link DataStore to Memory2--><path d="M238.71,343.35 C247.67,374.52 263.51,429.63 273.05,462.84 " fill="none" id="DataStore-to-Memory2" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="274.53,467.97,275.9113,458.2185,273.1602,463.1613,268.2173,460.4102,274.53,467.97" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[e68cc46f9c1f5e5c19be3cc431957f48]
link Key plugin to Disk--><path d="M677,343.35 C677,374.52 677,429.63 677,462.84 " fill="none" id="Key plugin-to-Disk" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="677,467.97,681,458.97,677,462.97,673,458.97,677,467.97" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[753bea95a68f99607698b29e80d24878]
link Key plugin to HSM--><path d="M665.63,343.35 C650.4,374.64 623.41,430.08 607.27,463.25 " fill="none" id="Key plugin-to-HSM" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="604.97,467.97,612.5002,461.622,607.1545,463.4725,605.3041,458.1268,604.97,467.97" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a148a3163ddac1ace302fe49b103331e]
link Key plugin to Memory--><path d="M689.87,343.35 C707.13,374.64 737.69,430.08 755.98,463.25 " fill="none" id="Key plugin-to-Memory" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="758.58,467.97,757.7439,458.1567,756.1688,463.5898,750.7356,462.0147,758.58,467.97" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[0e247d17824cae6a3303ce0fe343a2e2]
@startuml IoTEdge_SPIFFE_server
database "HSM"
database "Disk"
database "SQL"
database "Memory"
database "Memory2"

frame "IoTEdgeSPIFFE Server" {

[API SVIDs]-[hidden]left->[API Trust bundle]
[API Trust bundle]-[hidden]left->[Node attestation]
[Admin inputs]-right->[DataStore]

[API Trust bundle] -down->[DataStore]: Get pub keys
[API SVIDs]-down- ->[DataStore]: Check entries 
[API SVIDs]-down->[SVID Signer]: Sign SVID 
[SVID Signer]-down-> [Key plugin] : Sign Digest
[Key Manager]-right->[Key plugin] : Add pkeys
[Key Manager]-left->[DataStore] : Add pub keys

[DataStore] - -down->[SQL]
[DataStore] - -down->[Memory2]
[Key plugin] - -down->[Disk]
[Key plugin] - -down->[HSM]
[Key plugin] - -down->[Memory]
}




@enduml

PlantUML version 1.2022.0(Tue Jan 11 08:16:42 PST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>